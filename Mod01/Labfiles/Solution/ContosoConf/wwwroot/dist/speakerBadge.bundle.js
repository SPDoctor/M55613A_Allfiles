(()=>{var t={974(){function t(t,e){var n=.34*t[e]+.5*t[e+1]+.16*t[e+2];t[e]=n,t[e+1]=n,t[e+2]=n}addEventListener("message",function(e){for(var n=e.data,a=n.data,i=0;i<a.length;i+=4)t(a,i);postMessage({done:n})})}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,n),r.exports}(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,a(i.key),i)}}function a(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}n(974),new(function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e.querySelector("canvas"),this.busyElement=e.querySelector(".busy"),this.speakerId=this.canvas.getAttribute("data-speaker-id"),this.speakerName=this.canvas.getAttribute("data-speaker-name"),this.canvas.addEventListener("dragover",this.handleDragOver.bind(this)),this.canvas.addEventListener("drop",this.handleDrop.bind(this)),this.drawBadge()},(n=[{key:"handleDragOver",value:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}},{key:"handleDrop",value:function(t){var e=this;t.stopPropagation(),t.preventDefault();var n=t.dataTransfer.files;if(0!=n.length){var a=n[0];this.isImageType(a.type)?(this.busy(),this.readFile(a).then(function(t){return e.loadImage(t)}).then(function(t){return e=t,new Promise(function(t,n){var a,i,r=(a=e,(i=document.createElement("canvas")).setAttribute("width",a.width),i.setAttribute("height",a.height),i),o=r.getContext("2d"),s=function(t,e){return t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height)}(o,e),l=new Worker("/scripts/grayscale-worker.js");l.addEventListener("message",function(e){o.clearRect(0,0,r.width,r.height),o.putImageData(s,0,0),t([r])}.bind(this)),l.postMessage(s)});var e}).then(function(t){return e.notBusy(t)})):alert("Please drop an image file.")}}},{key:"drawBadge",value:function(t){this.context=this.canvas.getContext("2d"),this.drawBackground(),this.drawTopText(),this.drawSpeakerName(),t?this.drawSpeakerImage(t):this.drawImagePlaceholder(),this.drawBarCode(this.speakerId)}},{key:"drawBackground",value:function(){this.context.fillStyle="white",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"drawSpeakerImage",value:function(t){var e=Math.min(t.width,t.height),n=t.width/2-e/2,a=t.height/2-e/2;this.context.drawImage(t,n,a,e,e,20,20,160,160)}},{key:"drawImagePlaceholder",value:function(){this.context.strokeStyle="2px #888",this.context.strokeRect(20,20,160,160),this.context.font="12px sans-serif",this.context.textBaseline="middle",this.context.textAlign="center",this.context.fillStyle="black",this.context.fillText("Drag your profile photo here",100,100)}},{key:"drawTopText",value:function(){this.context.font="20px sans-serif",this.context.fillStyle="black",this.context.textBaseline="top",this.context.textAlign="left",this.context.fillText("ContosoConf 2013 Speaker:",200,20)}},{key:"drawSpeakerName",value:function(){this.context.font="40px sans-serif",this.context.fillStyle="black",this.context.textBaseline="top",this.context.textAlign="left",this.context.fillText(this.speakerName,200,60)}},{key:"drawBarCode",value:function(t){t="*"+t+"*";for(var e={0:"bwbWBwBwb",1:"BwbWbwbwB",2:"bwBWbwbwB",3:"BwBWbwbwb",4:"bwbWBwbwB",5:"BwbWBwbwb",6:"bwBWBwbwb",7:"bwbWbwBwB",8:"BwbWbwBwb",9:"bwBWbwBwb","*":"bWbwBwBwb"},n=200,a=0;a<t.length;a++){for(var i=e[t[a]],r=0;r<i.length;r++)this.context.fillStyle=r%2==0?"black":"white",i.charCodeAt(r)<91?(this.context.fillRect(n,140,6,40),n+=6):(this.context.fillRect(n,140,2,40),n+=2);a<t.length-1&&(this.context.fillStyle="white",this.context.fillRect(n,140,2,40),n+=2)}}},{key:"isImageType",value:function(t){return 0===["image/jpeg","image/jpg","image/png"].indexOf(t)}},{key:"readFile",value:function(t){return new Promise(function(e,n){var a=new FileReader;a.onload=function(t){var n=t.target.result;e([n])},a.readAsDataURL(t)})}},{key:"loadImage",value:function(t){return new Promise(function(e,n){var a=new Image;a.onload=function(){e(a)},a.src=t})}},{key:"busy",value:function(){this.busyElement.style.display="block"}},{key:"notBusy",value:function(){this.busyElement.style.display="none"}}])&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}())(document.querySelector(".badge"))})()})();
//# sourceMappingURL=speakerBadge.bundle.js.map