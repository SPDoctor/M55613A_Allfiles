/*! For license information please see schedule.bundle.js.LICENSE.txt */
(()=>{"use strict";function t(t){var e=t.split(":");return 60*parseInt(e[0],10)+parseInt(e[1],10)}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(){var t,e,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function s(n,o,i,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return r(l,"_invoke",function(n,r,o){var i,a,s,c=0,l=o||[],f=!1,y={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,a=0,s=t,y.n=n,u}};function h(n,r){for(a=n,s=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=y.p,v=i[2];n>3?(o=v===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(a=0,y.v=r,y.n=i[1]):h<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,y.n=v,a=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,v){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,v),a=l,s=v;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(y.n=-1),h(a,s)):y.n=s:y.v=s);try{if(c=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=y.n<0)?s:n.call(r,y))!==u)break}catch(e){i=t,a=1,s=e}finally{c=1}}return{value:e,done:f}}}(n,i,a),!0),l}var u={};function c(){}function l(){}function f(){}e=Object.getPrototypeOf;var y=[][i]?e(e([][i]())):(r(e={},i,function(){return this}),e),h=f.prototype=c.prototype=Object.create(y);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,r(t,a,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=f,r(h,"constructor",f),r(f,"constructor",l),l.displayName="GeneratorFunction",r(f,a,"GeneratorFunction"),r(h),r(h,a,"Generator"),r(h,i,function(){return this}),r(h,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:v}})()}function r(t,e,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}r=function(t,e,n,o){function a(e,n){r(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},r(t,e,n,o)}function o(t,e,n,r,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,o)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a(r.key),r)}}function a(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var s=function(){return e=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.tracks=e.tracks,this.localStarStorage=n,this.element=this.createSessionElement(e),this.starredClass="starred",n.isStarred(this.id)&&this.element.classList.add(this.starredClass),this.initializeElementClass(),this.initializeElementPosition(e.start,e.end),this.addStarClickEventHandler()},r=[{key:"createSessionElement",value:function(t){var e=document.createElement("li");return e.className="schedule-item",e.innerHTML="\n            <span>".concat(t.title,'</span>\n            <div class="star"></div>\n            <div class="star-count">').concat(t.starCount||0,"</div>\n        "),e}},{key:"initializeElementClass",value:function(){this.isInTrack(1)&&this.isInTrack(2)?this.element.classList.add("both-tracks"):this.isInTrack(1)?this.element.classList.add("track-1"):this.isInTrack(2)&&this.element.classList.add("track-2")}},{key:"initializeElementPosition",value:function(e,n){var r=t(e),o=t(n);this.element.style.top=2*(r-510)+"px",this.element.style.height=2*(o-r)+"px"}},{key:"addStarClickEventHandler",value:function(){this.element.querySelector(".star").addEventListener("click",this.toggleStar.bind(this),!1)}},{key:"isInTrack",value:function(t){return this.tracks.indexOf(t)>=0}},{key:"toggleStar",value:function(){this.isStarred()?this.unsetStar():this.setStar()}},{key:"isStarred",value:function(){return this.element.classList.contains(this.starredClass)}},{key:"unsetStar",value:function(){this.element.classList.remove(this.starredClass),this.postStarChange(!1),this.localStarStorage.removeStar(this.id)}},{key:"setStar",value:function(){this.element.classList.add(this.starredClass),this.postStarChange(!0),this.localStarStorage.addStar(this.id)}},{key:"postStarChange",value:(a=n().m(function t(e){var r,o,i,a;return n().w(function(t){for(;;)switch(t.n){case 0:return r=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),o={method:"POST",headers:r,body:"starred="+e},t.n=1,fetch("/schedule/star/"+this.id,o);case 1:if(i=t.v,!e){t.n=3;break}if(!i.ok){t.n=3;break}return t.n=2,i.json();case 2:a=t.v,this.updateStarCount(a.starCount),a.starCount>50&&alert("This session is very popular! Be sure to arrive early to get a seat.");case 3:return t.a(2)}},t,this)}),s=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=a.apply(t,e);function s(t){o(i,n,r,s,u,"next",t)}function u(t){o(i,n,r,s,u,"throw",t)}s(void 0)})},function(t){return s.apply(this,arguments)})},{key:"updateStarCount",value:function(t){this.element.querySelector(".star-count").textContent=t.toString()}},{key:"show",value:function(){this.element.style.display="block"}},{key:"hide",value:function(){this.element.style.display="none"}}],r&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,a,s}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof s?r:s,c=Object.create(u.prototype);return l(c,"_invoke",function(n,r,o){var i,s,u,c=0,l=o||[],f=!1,y={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,s=0,u=t,y.n=n,a}};function h(n,r){for(s=n,u=r,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],h=y.p,v=i[2];n>3?(o=v===r)&&(u=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,y.v=r,y.n=i[1]):h<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,y.n=v,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,v){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,v),s=l,u=v;(e=s<2?t:u)||!f;){i||(s?s<3?(s>1&&(y.n=-1),h(s,u)):y.n=u:y.v=u);try{if(c=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(f=y.n<0)?u:n.call(r,y))!==a)break}catch(e){i=t,s=1,u=e}finally{c=1}}return{value:e,done:f}}}(n,o,i),!0),c}var a={};function s(){}function u(){}function f(){}e=Object.getPrototypeOf;var y=[][r]?e(e([][r]())):(l(e={},r,function(){return this}),e),h=f.prototype=s.prototype=Object.create(y);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return u.prototype=f,l(h,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,r,function(){return this}),l(h,"toString",function(){return"[object Generator]"}),(c=function(){return{w:i,m:v}})()}function l(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,n,r){function i(e,n){l(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},l(t,e,n,r)}function f(t,e,n,r,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,o)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}var v=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.localStarStorage=n,this.items=[]},e=[{key:"startDownload",value:(n=c().m(function t(){var e,n;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/schedule/list");case 1:return e=t.v,t.n=2,e.json();case 2:n=t.v,e.ok?this.downloadDone(n):this.downloadFailed();case 3:return t.a(2)}},t,this)}),r=function(){var t=this,e=arguments;return new Promise(function(r,o){var i=n.apply(t,e);function a(t){f(i,r,o,a,s,"next",t)}function s(t){f(i,r,o,a,s,"throw",t)}a(void 0)})},function(){return r.apply(this,arguments)})},{key:"downloadDone",value:function(t){this.addAll(t.schedule)}},{key:"downloadFailed",value:function(){alert("Could not retrieve schedule data at this time. Please try again later.")}},{key:"addAll",value:function(t){t.forEach(this.add,this)}},{key:"add",value:function(t){var e=new s(t,this.localStarStorage);this.items.push(e),this.element.appendChild(e.element)}}],e&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==p(e)?e:e+""}var b=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.localStorage=e,this.load()},(e=[{key:"addStar",value:function(t){this.isStarred(t)||(this.sessions.push(t),this.save())}},{key:"removeStar",value:function(t){var e=this.sessions.indexOf(t);e>=0&&(this.sessions.splice(e,1),this.save())}},{key:"isStarred",value:function(t){return this.sessions.indexOf(t)>=0}},{key:"load",value:function(){var t=this.localStorage.getItem("stars");if(t)try{this.sessions=JSON.parse(t)||[]}catch(t){this.sessions=[]}else this.sessions=[]}},{key:"save",value:function(){this.localStorage.setItem("stars",JSON.stringify(this.sessions))}}])&&d(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();new v(document.getElementById("schedule"),new b(localStorage)).startDownload()})();
//# sourceMappingURL=schedule.bundle.js.map