{"version":3,"file":"live.bundle.js","mappings":"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","sources":["webpack://asp.net/./wwwroot/scripts/LivePage.js","webpack://asp.net/./wwwroot/scripts/pages/live.js"],"sourcesContent":["export class LivePage {\r\n\r\n    constructor(socket, sectionElement) {\r\n        this.initializeSocket(socket);\r\n        this.initializeUI(sectionElement);\r\n    }\r\n\r\n    initializeSocket(socket) {\r\n        this.socket = socket;\r\n        // TODO: Assign a callback to handle messages from the socket.\r\n        this.socket.onmessage = this.handleSocketMessage.bind(this);\r\n    }\r\n\r\n    initializeUI(sectionElement) {\r\n        this.questionListElement = sectionElement.querySelector(\"ul\");\r\n        this.questionInput = sectionElement.querySelector(\"input\");\r\n\r\n        const form = sectionElement.querySelector(\"form\");\r\n        form.addEventListener(\"click\", this.handleFormSubmit.bind(this), false);\r\n\r\n        this.questionListElement.addEventListener(\"click\", this.handleQuestionsClick.bind(this), false);\r\n    }\r\n\r\n    handleFormSubmit(event) {\r\n        // Prevent the form actually submitting.\r\n        event.preventDefault();\r\n\r\n        const text = this.questionInput.value;\r\n        if (text) {\r\n            this.askQuestion(text);\r\n        }\r\n    }\r\n\r\n    askQuestion(text) {\r\n        // TODO: Create a message object with the format { ask: text }\r\n        const message = {\r\n            ask: text\r\n        };\r\n        // TODO: Convert the message object into a JSON string\r\n        const json = JSON.stringify(message);\r\n        // TODO: Send the message to the socket\r\n        this.socket.send(json);\r\n\r\n        // Clear the input ready for another question.\r\n        this.questionInput.value = \"\";\r\n    }\r\n\r\n    handleSocketMessage(event) {\r\n        // TODO: Parse the event data into message object.\r\n        const message = JSON.parse(event.data);\r\n        if (message.questions) {\r\n            this.handleQuestionsMessage(message);\r\n        } else if (message.remove) {\r\n            this.handleRemoveMessage(message);\r\n        }\r\n    }\r\n\r\n    handleQuestionsMessage(message) {\r\n        // message has the form:\r\n        //   { questions: [\r\n        //         { text: \"...\", id: 1 },\r\n        //         { text: \"...\", id: 2 }\r\n        //   ] }\r\n\r\n        // TODO: Display each question in the page, using the displayQuestion function.\r\n        message.questions.forEach(this.displayQuestion, this);\r\n    }\r\n\r\n    handleRemoveMessage(message) {\r\n        const listItems = this.questionListElement.querySelectorAll(\"li\");\r\n        for (let i = 0; i < listItems.length; i++) {\r\n            if (listItems[i].questionId === message.remove) {\r\n                this.questionListElement.removeChild(listItems[i]);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    displayQuestion(question) {\r\n        const item = this.createQuestionItem(question);\r\n        item.appendChild(this.createReportLink());\r\n        this.questionListElement.appendChild(item);\r\n    }\r\n\r\n    createQuestionItem(question) {\r\n        const item = document.createElement(\"li\");\r\n        // BAD: textContent is safe, but best to be explicit about sanitization\r\n        item.textContent = question.text + \" \";\r\n        item.questionId = question.id;\r\n        return item;\r\n    }\r\n\r\n    createReportLink() {\r\n        const report = document.createElement(\"a\");\r\n        report.textContent = \"Report\";\r\n        report.setAttribute(\"href\", \"#\");\r\n        report.setAttribute(\"class\", \"report\");\r\n        return report;\r\n    }\r\n\r\n    handleQuestionsClick(event) {\r\n        event.preventDefault();\r\n\r\n        const clickedElement = event.target;\r\n        if (this.isReportLink(clickedElement)) {\r\n            const questionId = clickedElement.parentNode.questionId;\r\n            this.reportQuestion(questionId);\r\n            clickedElement.textContent = \"Reported\";\r\n        }\r\n    }\r\n\r\n    isReportLink(element) {\r\n        return element.classList && element.classList.contains(\"report\");\r\n    }\r\n\r\n    reportQuestion(questionId) {\r\n        // TODO: Send socket message { report: questionId }\r\n        this.socket.send(JSON.stringify({ report: questionId }));\r\n    }\r\n}\r\n","import { LivePage } from \"../LivePage.js\";\n// Create a web socket connection to /live/socket\nconst protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\nconst socket = new WebSocket(`${protocol}//${window.location.host}/live/socket`);\nnew LivePage(\n    socket,\n    document.querySelector(\"section.live\")\n);\n"],"names":["LivePage","socket","sectionElement","_classCallCheck","this","initializeSocket","initializeUI","key","value","onmessage","handleSocketMessage","bind","questionListElement","querySelector","questionInput","addEventListener","handleFormSubmit","handleQuestionsClick","event","preventDefault","text","askQuestion","message","ask","json","JSON","stringify","send","parse","data","questions","handleQuestionsMessage","remove","handleRemoveMessage","forEach","displayQuestion","listItems","querySelectorAll","i","length","questionId","removeChild","question","item","createQuestionItem","appendChild","createReportLink","document","createElement","textContent","id","report","setAttribute","clickedElement","target","isReportLink","parentNode","reportQuestion","element","classList","contains","protocol","window","location","WebSocket","concat","host"],"ignoreList":[],"sourceRoot":""}