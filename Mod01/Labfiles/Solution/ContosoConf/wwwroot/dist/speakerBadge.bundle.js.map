{"version":3,"file":"speakerBadge.bundle.js","mappings":"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","sources":["webpack://asp.net/./wwwroot/scripts/grayscale-worker.js","webpack://asp.net/webpack/bootstrap","webpack://asp.net/./wwwroot/scripts/pages/speaker-badge.js","webpack://asp.net/./wwwroot/scripts/SpeakerBadgePage.js","webpack://asp.net/./wwwroot/scripts/grayscale.js"],"sourcesContent":["// This script is for a Web Worker.\r\naddEventListener(\"message\", function (event) {\r\n    const imageData = event.data;\r\n    const pixels = imageData.data;\r\n    for (let i = 0; i < pixels.length; i += 4) {\r\n        grayscalePixel(pixels, i);\r\n    }\r\n    postMessage({ done: imageData });\r\n});\r\n\r\nfunction grayscalePixel(pixels, index) {\r\n    /// <summary>Updates the pixel, starting at the given index, to be gray scale.</summary>\r\n\r\n    const brightness = 0.34 * pixels[index] + 0.5 * pixels[index + 1] + 0.16 * pixels[index + 2];\r\n\r\n    pixels[index] = brightness; // red\r\n    pixels[index + 1] = brightness; // green\r\n    pixels[index + 2] = brightness; // blue\r\n};\r\n\r\n\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { SpeakerBadgePage } from \"../SpeakerBadgePage.js\";\r\n\r\nconst badgeElement = document.querySelector(\".badge\");\r\nnew SpeakerBadgePage(badgeElement);\r\n\r\n\r\n","import { grayscaleImage } from \"./grayscale.js\";\r\n\r\nexport class SpeakerBadgePage {\r\n\r\n    constructor(element) {\r\n        this.canvas = element.querySelector(\"canvas\");\r\n        this.busyElement = element.querySelector(\".busy\");\r\n\r\n        this.speakerId = this.canvas.getAttribute(\"data-speaker-id\");\r\n        this.speakerName = this.canvas.getAttribute(\"data-speaker-name\");\r\n        this.canvas.addEventListener(\"dragover\", this.handleDragOver.bind(this));\r\n        this.canvas.addEventListener(\"drop\", this.handleDrop.bind(this));\r\n\r\n        this.drawBadge();\r\n    }\r\n\r\n    handleDragOver(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        event.dataTransfer.dropEffect = 'copy'; // Makes the browser display a \"copy\" cursor.\r\n    }\r\n\r\n    handleDrop(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n\r\n        const files = event.dataTransfer.files;\r\n        if (files.length == 0) return;\r\n\r\n        // More than one file could have been dropped, we'll just use the first.\r\n        const file = files[0];\r\n        if (this.isImageType(file.type)) {\r\n            this.busy();\r\n            // TODO: Add grayscaleImage into the processing pipeline.\r\n            this.readFile(file)\r\n                .then((file) => this.loadImage(file))\r\n                .then((file) => grayscaleImage(file))\r\n                .then((file) => this.notBusy(file));\r\n        } else {\r\n            alert(\"Please drop an image file.\");\r\n        }\r\n    }\r\n\r\n    drawBadge(image) {\r\n        this.context = this.canvas.getContext(\"2d\");\r\n        this.drawBackground();\r\n        this.drawTopText();\r\n        this.drawSpeakerName();\r\n        if (image) {\r\n            this.drawSpeakerImage(image);\r\n        } else {\r\n            this.drawImagePlaceholder();\r\n        }\r\n        this.drawBarCode(this.speakerId);\r\n    }\r\n\r\n    drawBackground() {\r\n        this.context.fillStyle = \"white\";\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    drawSpeakerImage(image) {\r\n        const size = Math.min(image.width, image.height);\r\n        const sourceX = image.width / 2 - size / 2;\r\n        const sourceY = image.height / 2 - size / 2;\r\n        this.context.drawImage(image, sourceX, sourceY, size, size, 20, 20, 160, 160);\r\n    }\r\n\r\n    drawImagePlaceholder() {\r\n        this.context.strokeStyle = \"2px #888\";\r\n        this.context.strokeRect(20, 20, 160, 160);\r\n        this.context.font = \"12px sans-serif\";\r\n        this.context.textBaseline = \"middle\";\r\n        this.context.textAlign = \"center\";\r\n        this.context.fillStyle = \"black\";\r\n        this.context.fillText(\"Drag your profile photo here\", 100, 100);\r\n    }\r\n\r\n    drawTopText() {\r\n        this.context.font = \"20px sans-serif\";\r\n        this.context.fillStyle = \"black\";\r\n        this.context.textBaseline = \"top\";\r\n        this.context.textAlign = \"left\";\r\n        this.context.fillText(\"ContosoConf 2013 Speaker:\", 200, 20);\r\n    }\r\n\r\n    drawSpeakerName() {\r\n        this.context.font = \"40px sans-serif\";\r\n        this.context.fillStyle = \"black\";\r\n        this.context.textBaseline = \"top\";\r\n        this.context.textAlign = \"left\";\r\n        this.context.fillText(this.speakerName, 200, 60);\r\n    }\r\n\r\n    drawBarCode(text) {\r\n        text = \"*\" + text + \"*\"; // Wrap in \"*\" deliminators.\r\n        const encodings = {\r\n            \"0\": \"bwbWBwBwb\",\r\n            \"1\": \"BwbWbwbwB\",\r\n            \"2\": \"bwBWbwbwB\",\r\n            \"3\": \"BwBWbwbwb\",\r\n            \"4\": \"bwbWBwbwB\",\r\n            \"5\": \"BwbWBwbwb\",\r\n            \"6\": \"bwBWBwbwb\",\r\n            \"7\": \"bwbWbwBwB\",\r\n            \"8\": \"BwbWbwBwb\",\r\n            \"9\": \"bwBWbwBwb\",\r\n            \"*\": \"bWbwBwBwb\"\r\n        };\r\n        let x = 200, y = 140, height = 40, thick = 6, thin = 2;\r\n        for (let charIndex = 0; charIndex < text.length; charIndex++) {\r\n            const code = encodings[text[charIndex]];\r\n            for (let stripeIndex = 0; stripeIndex < code.length; stripeIndex++) {\r\n                if (stripeIndex % 2 === 0) {\r\n                    this.context.fillStyle = \"black\";\r\n                } else {\r\n                    this.context.fillStyle = \"white\";\r\n                }\r\n                const isWideStripe = code.charCodeAt(stripeIndex) < 91;\r\n                if (isWideStripe) {\r\n                    this.context.fillRect(x, y, thick, height);\r\n                    x += thick;\r\n                } else {\r\n                    this.context.fillRect(x, y, thin, height);\r\n                    x += thin;\r\n                }\r\n            }\r\n\r\n            if (charIndex < text.length - 1) {\r\n                // Space between each\r\n                this.context.fillStyle = \"white\";\r\n                this.context.fillRect(x, y, thin, height);\r\n                x += thin;\r\n            }\r\n        }\r\n    }\r\n\r\n    isImageType(type) {\r\n        const imageTypes = [\"image/jpeg\", \"image/jpg\", \"image/png\"];\r\n        return imageTypes.indexOf(type) === 0;\r\n    }\r\n\r\n    readFile(file) {\r\n        // Return a new promise.\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            const reader = new FileReader();\r\n\r\n            reader.onload = function (loadEvent) {\r\n                const fileDataUrl = loadEvent.target.result;\r\n\r\n                resolve([fileDataUrl]);\r\n            };\r\n\r\n            reader.readAsDataURL(file);\r\n        });\r\n    }\r\n\r\n    loadImage(imageUrl) {\r\n         // Return a new promise.\r\n         return new Promise(function (resolve, reject) {\r\n            const image = new Image();\r\n\r\n            image.onload = function () {\r\n                resolve(image);\r\n            };\r\n\r\n            image.src = imageUrl; // This starts the image loading\r\n        });\r\n    }\r\n\r\n    busy() {\r\n        this.busyElement.style.display = \"block\";\r\n    }\r\n\r\n    notBusy() {\r\n        this.busyElement.style.display = \"none\";\r\n    }\r\n}\r\n","import { grayscalePixel } from \"./grayscale-worker.js\";\r\nfunction createCanvas(size) {\r\n    /// <summary>Creates a canvas used for image manipulation.</summary>\r\n\r\n    const temporaryCanvas = document.createElement(\"canvas\");\r\n    temporaryCanvas.setAttribute(\"width\", size.width);\r\n    temporaryCanvas.setAttribute(\"height\", size.height);\r\n    return temporaryCanvas;\r\n};\r\n\r\nfunction getImageData(context, image) {\r\n    /// <summary>Draws the image onto the canvas context, then returns the resulting image data.</summary>\r\n\r\n    context.drawImage(image, 0, 0);\r\n    return context.getImageData(0, 0, image.width, image.height);\r\n};\r\n\r\n\r\n\r\nexport function grayscaleImage(image) {\r\n    // Converts a colour image into gray scale.\r\n\r\n    // Return a new promise.\r\n    return new Promise(function (resolve, reject) {   \r\n        const canvas = createCanvas(image);\r\n        const context = canvas.getContext(\"2d\");\r\n        const imageData = getImageData(context, image);\r\n\r\n        // TODO: Create a Worker that runs /scripts/grayscale-worker.js\r\n        const worker = new Worker(\"/scripts/grayscale-worker.js\");\r\n        const handleMessage = function (event) {\r\n            // Update the canvas with the gray scaled image data.\r\n            context.clearRect(0, 0, canvas.width, canvas.height);\r\n            context.putImageData(imageData, 0, 0);\r\n\r\n            // Returning a Promise makes this function easy to chain together with other deferred operations.\r\n            // The canvas object is returned as this can be used like an image.\r\n            resolve([canvas]);\r\n        };\r\n        worker.addEventListener(\"message\", handleMessage.bind(this));\r\n        worker.postMessage(imageData);\r\n\r\n       \r\n    });\r\n};\r\n\r\n"],"names":["grayscalePixel","pixels","index","brightness","addEventListener","event","imageData","data","i","length","postMessage","done","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","SpeakerBadgePage","element","_classCallCheck","this","canvas","querySelector","busyElement","speakerId","getAttribute","speakerName","handleDragOver","bind","handleDrop","drawBadge","key","value","stopPropagation","preventDefault","dataTransfer","dropEffect","_this","files","file","isImageType","type","busy","readFile","then","loadImage","image","Promise","resolve","reject","size","temporaryCanvas","document","createElement","setAttribute","width","height","context","getContext","drawImage","getImageData","worker","Worker","clearRect","putImageData","notBusy","alert","drawBackground","drawTopText","drawSpeakerName","drawSpeakerImage","drawImagePlaceholder","drawBarCode","fillStyle","fillRect","Math","min","sourceX","sourceY","strokeStyle","strokeRect","font","textBaseline","textAlign","fillText","text","encodings","x","charIndex","code","stripeIndex","charCodeAt","indexOf","reader","FileReader","onload","loadEvent","fileDataUrl","target","result","readAsDataURL","imageUrl","Image","src","style","display"],"ignoreList":[],"sourceRoot":""}